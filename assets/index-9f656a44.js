import{K as U,r as m,D as X,c as Y,d as s,N as Z,o as y,e as x,f as t,w as o,z as ee,q as E,g as T,h as d,k as N,t as ae,B as R,y as L,L as p}from"./index-9dd9b327.js";const b={TRADEMARK_URL:"/admin/product/baseTrademark",ADDTRADEMARK_URL:"/admin/product/baseTrademark/save",UPDATETRADEMARK_URL:"/admin/product/baseTrademark/update",DELETE_URL:"/admin/product/baseTrademark/remove"},te=(c,n)=>U.get(b.TRADEMARK_URL+`/${c}/${n}`),le=c=>c.id?U.put(b.UPDATETRADEMARK_URL,c):U.post(b.ADDTRADEMARK_URL,c),oe=c=>U.delete(b.DELETE_URL+`/${c}`);const re={style:{color:"brown"}},se=["src"],ne=["src"],ce={__name:"index",setup(c){let n=m(1),_=m(3),h=m(0),k=m([]);const g=async(l=1)=>{n.value=l;let a=await te(n.value,_.value);a.code==200&&(h.value=a.data.total,k.value=a.data.records)};X(()=>{g()});let u=m(!1),r=Y({tmName:"",logoUrl:""}),f=m();const z=()=>{u.value=!0,r.id=0,r.tmName="",r.logoUrl="",L(()=>{f.value.clearValidate(["tmName","logoUrl"])})},V=()=>{u.value=!1},C=async()=>{f.value.validate().then(async()=>{(await le(r)).code==200?(u.value=!1,p({type:"success",message:r.id?"修改品牌成功":"添加品牌成功"}),g(r.id?n.value:1)):(p({type:"error",message:r.id?"修改品牌失败":"添加品牌失败"}),u.value=!1)}).catch(l=>{console.log(l)})},w=l=>["image/png","image/jpeg","image/png"].includes(l.type)?l.size/1024/1024<4?!0:(p({type:"error",message:"上传文件大小小于4M"}),!1):(p({type:"error",message:"上传文件格式务必PNG|JPG|GIF"}),!1),M=(l,a)=>{r.logoUrl=l.data,f.value.clearValidate("logoUrl")},P=l=>{L(()=>{f.value.clearValidate(["tmName","logoUrl"])}),u.value=!0,Object.assign(r,l)},O={tmName:[{required:!0,trigger:"blur",validator:(l,a,i)=>{a.trim().length>=2?i():i(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(l,a,i)=>{a?i():i(new Error("LOGO图片务必上传"))}}]},$=async l=>{(await oe(l)).code==200?(p({type:"success",message:"删除品牌成功"}),g(k.value.length>1?n.value:n.value-1)):p({type:"error",message:"删除品牌失败"})};return(l,a)=>{const i=s("el-button"),v=s("el-table-column"),q=s("el-popconfirm"),K=s("el-table"),G=s("el-pagination"),S=s("el-card"),j=s("el-input"),A=s("el-form-item"),B=s("Plus"),F=s("el-icon"),H=s("el-upload"),I=s("el-form"),J=s("el-dialog"),W=Z("has");return y(),x("div",null,[t(S,{class:"box-card"},{default:o(()=>[ee((y(),E(i,{type:"primary",size:"default",icon:"Plus",onClick:z},{default:o(()=>[T(" 添加品牌 ")]),_:1})),[[W,"btn.Trademark.add"]]),t(K,{style:{margin:"10px 0"},border:"",data:d(k)},{default:o(()=>[t(v,{label:"序号",width:"80px",align:"center",type:"index"}),t(v,{label:"品牌名称"},{default:o(({row:e,$index:D})=>[N("pre",re,ae(e.tmName),1)]),_:1}),t(v,{label:"品牌LOGO"},{default:o(({row:e,$index:D})=>[N("img",{src:e.logoUrl.startsWith("http://")?e.logoUrl:`http://${e.logoUrl}`,style:{width:"100px",height:"100px"}},null,8,se)]),_:1}),t(v,{label:"品牌操作"},{default:o(({row:e,$index:D})=>[t(i,{type:"primary",size:"small",icon:"Edit",onClick:Q=>P(e)},null,8,["onClick"]),t(q,{title:`您确定要删除${e.tmName}?`,width:"250px",icon:"Delete",onConfirm:Q=>$(e.id)},{reference:o(()=>[t(i,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),t(G,{background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:d(h),"pager-count":9,"current-page":d(n),"onUpdate:currentPage":a[0]||(a[0]=e=>R(n)?n.value=e:n=e),onCurrentChange:g,"page-size":d(_),"onUpdate:pageSize":a[1]||(a[1]=e=>R(_)?_.value=e:_=e),"page-sizes":[3,5,7,9,10],onSizeChange:a[2]||(a[2]=e=>g())},null,8,["total","current-page","page-size"])]),_:1}),t(J,{modelValue:d(u),"onUpdate:modelValue":a[4]||(a[4]=e=>R(u)?u.value=e:u=e),title:d(r).id?"修改品牌":"添加品牌"},{footer:o(()=>[t(i,{type:"primary",size:"default",onClick:V},{default:o(()=>[T("取消")]),_:1}),t(i,{type:"primary",size:"default",onClick:C},{default:o(()=>[T("确定")]),_:1})]),default:o(()=>[t(I,{style:{width:"80%"},"label-width":"100px",model:d(r),rules:O,ref_key:"formRef",ref:f},{default:o(()=>[t(A,{label:"品牌名称",prop:"tmName"},{default:o(()=>[t(j,{placeholder:"请您输入品牌名称",modelValue:d(r).tmName,"onUpdate:modelValue":a[3]||(a[3]=e=>d(r).tmName=e)},null,8,["modelValue"])]),_:1}),t(A,{label:"品牌LOGO",prop:"logoUrl"},{default:o(()=>[t(H,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"before-upload":w,"on-success":M},{default:o(()=>[d(r).logoUrl?(y(),x("img",{key:0,src:d(r).logoUrl,class:"avatar",width:"100",height:"100"},null,8,ne)):(y(),E(F,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[t(B)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{ce as default};
